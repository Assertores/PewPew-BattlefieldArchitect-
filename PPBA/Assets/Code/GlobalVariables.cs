using System.Collections;
using System.Collections.Generic;
using UnityEngine;

namespace PPBA
{
	public enum BuildType { REFINERY, WALL, SIZE };

	public class client
	{
		RingBuffer<GameState> _gameStates = new RingBuffer<GameState>();
	}

	public class GlobalVariables : Singleton<GlobalVariables>
	{
		#region Variables

		public static List<client> _clients = new List<client>();

		[Tooltip("deactivate this bool to signivy that this variables where set by us")]
		[SerializeField] private bool _autoGenerated = true;

		[System.Serializable]
		struct BuildAssignment
		{
			public BuildType _type;
			public GameObject _prefab;
		}
		[SerializeField] private BuildAssignment[] _prefabInput;

		[HideInInspector]public GameObject[] _prefabs;

		#endregion
		#region MonoBehaviour

		void Start()
		{
			//place variables or calculations that have to be set/done here
#if !UNITY_SERVER
			{
				client tmp = new client();
				_clients.Insert(0, tmp);
			}
#endif

			if(_autoGenerated)
			{
				Debug.LogError("Global Values where automaticly generated");
				return;
			}

			//place variables or calculation that must not be set or done if it is autogenerated
			DontDestroyOnLoad(this.gameObject);

			_prefabs = new GameObject[(int)BuildType.SIZE];
			foreach(var it in _prefabInput)
			{
				_prefabs[(int)it._type] = it._prefab;
			}

			ObjectPool.CreatePool(_prefabs[(int)BuildType.REFINERY], 100, transform);

		}

		#endregion
	}
}